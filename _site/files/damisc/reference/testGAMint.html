<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulated F-test for Linear Interactions — testGAMint • DAMisc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulated F-test for Linear Interactions — testGAMint" />
<meta property="og:description" content="Simluates the sampling distribution of the F statistic when comparing a
linear intreraction model to a generalized additive model with a smooth over
the two variables in the interaction." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DAMisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulated F-test for Linear Interactions</h1>
    
    <div class="hidden name"><code>testGAMint.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simluates the sampling distribution of the F statistic when comparing a
linear intreraction model to a generalized additive model with a smooth over
the two variables in the interaction.</p>
    </div>

    <pre class="usage"><span class='fu'>testGAMint</span>(<span class='no'>m1</span>, <span class='no'>m2</span>, <span class='no'>data</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>ranCoef</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>m1</th>
      <td><p>An object of class <code>gam</code> estimated with the <code>mgcv</code>
package.  This model should be linear in the interaction of the two
x-variables of interest.</p></td>
    </tr>
    <tr>
      <th>m2</th>
      <td><p>An object of class <code>gam</code> esimtated with the <code>mgcv</code>
package.  This model should contain a smooth interaction.  For two
continuous variables, this should be done with <code>te()</code> unless the
variables are measured in the same units (e.g., spatial coordinates) in
which case the usual thin-plate regression spline will work.  For
categorical moderators, you should use the <code>s(x, by=D0)</code> and <code>s(x,
by=D)</code> (for a dummy variable moderator, <code>D</code>, where <code>D0=1</code> when
<code>D=0</code>.  Remember to include <code>D</code> as a parametric term in the model
as well to account for the intercept difference between the two smooth
terms.)</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame used to estimate both models</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>Number of simulated F values to create.</p></td>
    </tr>
    <tr>
      <th>ranCoef</th>
      <td><p>Logcial indicating whether the coefficients should be treated
as fixed or whether they should be drawn from their implied sampling
distribution for each iteration of the simulation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>obsF</dt><dd><p>The observed F-statistic from the test on the original
models.</p></dd> <dt>Fdist</dt><dd><p>The <code>R</code> different F-statistics calculated at each
iteration of the simulation.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In simple simulations, an F-test of a linear interaction relative to a
smooth interaction with a GAM using a nominal .05 type I error rate, has an
actual type I error rate of more than double the nominal rate (this tended
to be in the low teens).  This function tries to build the F-distribution
using simulation.  First, it uses the coefficients from the linear
interaction model, multiplies them by the coefficients from the linear
interaction model and for each iteration of the simulation, it creates the
simulated dependent variable by adding a random error to the linear
predictor with the same standard deviation as the residual standard
deviation from the linear interaction model.  All of that is to say that
this model has all of the same features as the linear interaction model,
except that we are certain that this is the right model.  The algorithm then
estimates both the linear interaction model and the GAM with a smooth
interaction on the original X variables and the new simulated y variable.
The F-test is performed and the F-statistic saved for each iteraction.  The
algorithm then calculates the probability of being to the right of the
observed F-statistic in the simulated F-distribution.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
    </ul>

    <h2>Author</h2>
    <p>Dave Armstrong</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dave Armstrong.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


